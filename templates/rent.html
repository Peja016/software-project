{% extends "base.html" %}
{% block title %}Rent a Bike - Dublin Bike Share{% endblock %}
{% block style %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/rent.css') }}">
{% endblock %}
{% block content %}
{% import "components/rent_comp.html" as rent_module %}
    {{ rent_module.render_payment_modal() }}

    <section>
        <div class="container">
            <h1 class="section-title">Rent a Bike</h1>
            
            <div class="subscription-section">
                <h2 style="color: var(--custom-darkBlue); margin-bottom: 1.25rem;">Choose Your Plan</h2>
                
                <div class="subscription-options">
                    {{ rent_module.render_subscription_card([
                        {
                            'title': 'Annual Membership',
                            'price': '€35',
                            'period': '/ year',
                            'description': 'Perfect for daily commuters and regular users',
                            'features': [
                                'Unlimited 30-minute journeys',
                                'Quick and easy bike access',
                                'Mobile app features',
                                'Significant cost savings',
                                'Standard city bike'
                            ],
                            'plan': 'annual',
                            'price_value': '35.00',
                            'button_text': 'Subscribe Now'
                        },
                        {
                            'title': '3-Day Pass',
                            'price': '€5',
                            'period': '/ 3 days',
                            'description': 'Ideal for visitors and short trips around Dublin',
                            'features': [
                                'Unlimited 30-minute journeys for 3 days',
                                'Perfect for sightseeing',
                                'No need to worry about bike storage',
                                'Easily combine with public transport',
                                'Standard city bike'
                            ],
                            'plan': '3day',
                            'price_value': '5.00',
                            'button_text': 'Get Pass'
                        },
                        {
                            'title': 'Pay As You Go',
                            'price': '€2',
                            'period': '+ €0.50 per 30 min',
                            'description': 'For occasional rides with no commitment',
                            'features': [
                                '€2 bike unlocking fee',
                                '€0.50 for each 30 minutes of use',
                                'No subscription required',
                                'Perfect for spontaneous journeys',
                                'Standard city bike'
                            ],
                            'plan': 'payg',
                            'price_value': '2.00',
                            'button_text': 'Start Riding'
                        }
                    ]) }}
                </div>
            </div>
            
            <h2 style="color: var(--custom-darkBlue); margin-bottom: 1.25rem;">Rent for 1 hour</h2>
            
            <div class="bikes-container">
                {{ rent_module.render_bike_card([
                    {
                        'name': 'Standard City Bike',
                        'image': 'images/bike.jpeg',
                        'description': 'Comfortable and reliable for city commuting',
                        'specs': [
                            {'label': 'Weight', 'value': '18 kg'},
                            {'label': 'Gears', 'value': '3-speed'},
                            {'label': 'Frame', 'value': 'Aluminum'},
                            {'label': 'Brakes', 'value': 'Drum brakes'}
                        ],
                        'price': '€2.00 / hour',
                        'price_value': '2.00'
                    },
                    {
                        'name': 'Electric Bike',
                        'image': 'images/electric.jpeg',
                        'description': 'Perfect for longer journeys with pedal assistance',
                        'specs': [
                            {'label': 'Weight', 'value': '22 kg'},
                            {'label': 'Motor', 'value': '250W Mid-drive'},
                            {'label': 'Battery', 'value': '36V, 10Ah'},
                            {'label': 'Range', 'value': 'Up to 60 km'}
                        ],
                        'price': '€5.00 / hour',
                        'price_value': '5.00'
                    },
                    {
                        'name': 'Hybrid Bike',
                        'image': 'images/hybrid.jpeg',
                        'description': 'Versatile bike suitable for city and light trails',
                        'specs': [
                            {'label': 'Weight', 'value': '14 kg'},
                            {'label': 'Gears', 'value': '7-speed'},
                            {'label': 'Frame', 'value': 'Lightweight alloy'},
                            {'label': 'Tires', 'value': 'Semi-slick 700c'}
                        ],
                        'price': '€3.50 / hour',
                        'price_value': '3.50'
                    }
                ]) }}
            </div>
        </div>
    </section>
    
    <script>
        // Payment modal functionality
        const bookButtons = document.querySelectorAll('.book-btn');
        const subscriptionButtons = document.querySelectorAll('.subscription-btn');
        const paymentModal = document.getElementById('paymentModal');
        const paymentClose = document.querySelector('.payment-close');
        const selectedBikeName = document.getElementById('selectedBikeName');
        const selectedBikePrice = document.getElementById('selectedBikePrice');
        
        // Open payment modal from book buttons
        if (bookButtons) {
            bookButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const bikeName = this.getAttribute('data-bike-name');
                    const bikePrice = this.getAttribute('data-bike-price');
                    
                    selectedBikeName.textContent = bikeName;
                    selectedBikePrice.textContent = `€${bikePrice} per hour`;
                    
                    paymentModal.style.display = 'block';
                });
            });
        }
        
        // Open payment modal from subscription buttons
        if (subscriptionButtons) {
            subscriptionButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const plan = this.getAttribute('data-plan');
                    const price = this.getAttribute('data-price');
                    let planName;
                    
                    switch(plan) {
                        case 'annual':
                            planName = 'Annual Membership';
                            break;
                        case '3day':
                            planName = '3-Day Pass';
                            break;
                        case 'payg':
                            planName = 'Pay As You Go';
                            break;
                        default:
                            planName = 'Subscription';
                    }
                    
                    selectedBikeName.textContent = planName;
                    
                    if (plan === 'annual') {
                        selectedBikePrice.textContent = `€${price} per year`;
                    } else if (plan === '3day') {
                        selectedBikePrice.textContent = `€${price} for 3 days`;
                    } else {
                        selectedBikePrice.textContent = `€${price} + €0.50 per 30 min`;
                    }
                    
                    paymentModal.style.display = 'block';
                });
            });
        }
        
        // Close payment modal
        if (paymentClose) {
            paymentClose.addEventListener('click', function() {
                paymentModal.style.display = 'none';
            });
        }
        
        // Close payment modal when clicking outside
        window.addEventListener('click', function(event) {
            if (event.target === paymentModal) {
                paymentModal.style.display = 'none';
            }
        });
        
        // Payment tabs
        const paymentTabs = document.querySelectorAll('.payment-tab');
        
        if (paymentTabs) {
            paymentTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove active class from all tabs
                    paymentTabs.forEach(t => t.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Here you would show/hide content based on tab
                    // For demo purposes, we're not implementing this fully
                });
            });
        }
        
        // Payment form submission
        const paymentForm = document.getElementById('paymentForm');
        
        if (paymentForm) {
            paymentForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Basic validation for card number
                const cardNumber = document.getElementById('cardNumber').value;
                if (cardNumber.replace(/\s/g, '').length < 16) {
                    alert('Please enter a valid card number');
                    return;
                }
                
                // Here you would process payment through a payment gateway
                
                // For demo purposes
                alert('Payment successful! Your bike is ready for pickup. (Demo only)');
                paymentModal.style.display = 'none';
                paymentForm.reset();
            });
        }
    </script>
</body>
{% endblock %}